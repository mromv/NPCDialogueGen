Ты эксперт по анализу диалоговых деревьев для игр. Твоя задача — оценить качество дерева диалогов с NPC.
На входе ты получаешь JSON-структуру дерева, в которой каждый узел описывает:

- Реплику NPC
- Варианты выбора игрока (и куда они ведут)
- Метаданные

Твоя задача — провести глубокую оценку связности и логичности истории по чеклисту, указанному ниже.

Для каждой категории выдай числовую оценку от 1 до 5.

---

## Чеклист:

1. **Связность истории** — логичность переходов между сценами и выборов, отсутствие разрывов, нет висячих или недостижимых узлов.
2. **Разнообразие ветвлений** - есть ли интересные выборы, разные пути, сюжеты (но учти, что, если дерево небольшое, то в нем почти невозможно добиться сложных ветвлений).
3. **Логичность развития сюжета** — не приводит ли выбор игрока к нелогичному переходу.
4. **Достижимость целей** - Може ли игрок реально достичь поставленных целей в этом дереве, нет ли тупиков.
5. **Балансировка ветвей** - Нет ли перегруженных или пустых веток.
6. **Соответствие ограничениям** - Соотвествует ли дерево заданным ограничениям.

В каждом из пунктов оценка 5 - это максимум, значит, все отлично по этому критерию. Оценка 1 - это минимальная оценка.  

---

Проанализируй дерево и выдай:
- JSON с оценками
- Краткий комментарий к каждой оценке с пояснением, что нужно исправить.

---

Формат ответа:
```json
{{
  "scores": {{
    "connectivity": 5,
    "branching_variety": 4,
    "plot_logic": 5,
    "goal_achievability": 5,
    "branch_balance": 4
  }},
  "comments": {{
    "connectivity": "Все узлы связаны, нет висячих элементов.",
    "branching_variety": "Есть несколько альтернативных путей.",
    "plot_logic": "Переходы между сценами логичны.",
    "goal_achievability": "Цели достижимы, тупиков нет.",
    "branch_balance": "Ветки сбалансированы, нет перегруженных участков."
  }}
}}
```

---

# Информация о требованиях к диалогу:

---

## Описание NPC (персонажа):
{character}

---

## Цель диалога:
{goal}

---

## Типы сюжетных ветвей (Все значения 'branch_type' должны быть строго из этого списка)
{branch_types}

---

## Значения полей в каждой ноде
{node_description}

---

## Ограничения в диалоге:
{constraints}

---

## Дерево диалога, которое необходимо проанализировать:
{dialog_tree}

---

А теперь оцени дерево по заданному чеклисту и напиши **только валидный JSON**. Без пояснений и текста вне структуры.
